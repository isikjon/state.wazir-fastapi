<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Wazir Недвижимость - Главная</title>
        <link rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
        <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link
            href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@500;600;700&display=swap"
            rel="stylesheet">
        <link rel="stylesheet"
            href="{{ url_for('static', path='layout/assets/scss/main.css') }}">
        <style>

            .bottom-nav {
                box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
            }
            .nav-item {
                transition: all 0.2s ease;
            }
            .nav-item.active {
                color: var(--color-primary);
            }
            .nav-item:hover {
                color: var(--color-primary-hover);
            }            .city-banner {
                height: 220px; /* Высота баннера */
                background-image: url('https://wazir.kg/static/dashboard_bg.png');
                background-size: 117%;
                background-position: top center;
                background-repeat: no-repeat;
                margin-bottom: 0;
                border: none;
                position: relative;
            }
            /* Белая полоса с текстом */
            .banner-text {
                clip-path: polygon(6% 0%, 96% 0%, 100% 100%, 0% 100%);
                width: 63%;
                padding: 8px 0;
                background-color: white;
                text-align: center;
                font-size: 14px;
                font-weight: 500;
                font-family: 'Montserrat', sans-serif;
                color: #333;
                margin-bottom: 10px;
                position: absolute;
                bottom: -2px;
                left: 18%;
            }
            .city-content {
                position: relative;
                z-index: 2;
            }
            .weather-currency {
                font-size: 1.1rem;
                font-weight: 500;
            }
            .weather-icon {
                font-size: 1.4rem;
            }
            .nav-icons {
                font-size: 1.6rem;
                font-weight: 300;
            }

                        .category-card {
                transition: all 0.3s ease;
                height: 75px; /* Уменьшаем высоту */
                background-size: cover;
                background-position: center;
                position: relative;
                overflow: hidden;
                width: 100%; /* Делаем карточки шире */
                border-radius: 12px; /* Скругление */
                display: flex;
                justify-content: flex-start; /* Выравниваем содержимое слева */
                align-items: flex-start; /* Выравниваем содержимое вверху */
            }
            .category-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 12px rgba(0,0,0,0.08);
            }
            .category-card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: linear-gradient(90deg, rgba(0,0,0,0.5), rgba(0,0,0,0.3)); /* Увеличиваем затемнение для лучшей читаемости */
            }
            .category-title {
                position: relative;
                z-index: 2;
                text-align: left; /* Текст слева */
                padding-top: 9px;
                padding-left: 9px;
                font-size: 12px;
                text-shadow: 1px 1px 2px rgba(0,0,0,0.5); /* Тень для лучшей читаемости */
                text-decoration: underline;
            }
        </style>
    </head>
    <body class="bg-gray-100 font-sans">
        <div class="min-h-screen flex flex-col">
            <!-- Верхний блок: Лого, Погода, Валюта -->
            <header class="bg-white shadow-sm">
                <div class="container mx-auto px-4 py-1">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center"
                            style="box-shadow: 0px 6px 6px 0px rgba(0,0,0,0.21); padding: 0px 13px; border-radius: 8px; border: 1px solid #ccc;">
                            <p class="font-playfair"
                                style="font-size: 24px;">WAZIR</p>
                        </div>
                        <div class="flex items-center">
                            <div class="flex items-center weather-currency"
                                style="box-shadow: 0px 6px 6px 0px rgba(0,0,0,0.21); padding: 5px 12px; border-radius: 8px; border: 1px solid #ccc;">
                                <img src="https://flagcdn.com/w20/us.png"
                                    alt="USD" class="h-5 mr-2">
                                <span id="currency-rate">87.45</span>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Основное содержимое -->
            <main class="flex-grow">
                <!-- Баннер города -->
                <div class="city-banner">
                    <div class="banner-text"
                        style="display: flex; justify-content: center; margin: 0 auto;">
                        Вазир • Проект "МТТ"
                    </div>
                </div>

                <!-- Белая полоса с текстом -->

                <!-- Категории недвижимости -->
                <div class="mx-auto mb-16" style="background-color: #fff;">
                    <!-- Серый фон для карточек как на скриншоте 2 -->
                    <div class="rounded-md  mb-4" style="
padding-left: 5px;
padding-right: 5px;
padding-top: 5px;
padding-bottom: 5px;                    
                    "> <div class="grid grid-cols-2 gap-1"> <!-- Аренда -->
                            <div
                                class="category-card rounded-lg"
                                style="background-image: url('https://wazir.kg/static/categories/arenda.png')">
                                <h3
                                    class="category-title text-white font-medium font-montserrat">Аренда</h3>
                            </div>

                            <!-- Продажа -->
                            <div
                                class="category-card rounded-lg"
                                style="background-image: url('https://wazir.kg/static/categories/prodaja.png')">
                                <h3
                                    class="category-title text-white font-medium font-montserrat">Продажа</h3>
                            </div>

                            <!-- Новостройки -->
                            <div
                                class="category-card rounded-lg"
                                style="background-image: url('https://wazir.kg/static/categories/novostroyki.png')">
                                <h3
                                    class="category-title text-white font-medium font-montserrat">Новостройки</h3>
                            </div>

                            <!-- Посуточная -->
                            <div
                                class="category-card rounded-lg"
                                style="background-image: url('https://wazir.kg/static/categories/posutochnaya.png')">
                                <h3
                                    class="category-title text-white font-medium font-montserrat">Посуточная</h3>
                            </div>

                            <!-- Коммерческая -->
                            <div
                                class="category-card rounded-lg"
                                style="background-image: url('https://wazir.kg/static/categories/kommercheskaya.png')">
                                <h3
                                    class="category-title text-white font-medium font-montserrat">Коммерческая</h3>
                            </div>

                            <!-- Ипотека -->
                            <div
                                class="category-card rounded-lg"
                                style="background-image: url('https://wazir.kg/static/categories/ipoteka.png')">
                                <h3
                                    class="category-title text-white font-medium font-montserrat">Ипотека</h3>
                            </div>

                            <!-- Подбор риелтора -->
                            <div
                                class="category-card rounded-lg"
                                style="background-image: url('https://wazir.kg/static/categories/rieltor.png')">
                                <h3
                                    class="category-title text-white font-medium font-montserrat">Подбор
                                    риелтора</h3>
                            </div> <!-- Виртуальный тур -->
                            <div
                                class="category-card rounded-lg"
                                style="background-image: url('https://wazir.kg/static/categories/virtualniy.png')">
                                <h3
                                    class="category-title text-white font-medium font-montserrat">Виртуальный
                                    тур</h3>
                            </div>

                            <!-- Баннеры -->
                            <div
                                class="category-card rounded-lg"
                                style="background: linear-gradient(135deg, #808080 0%, #4f4f4f 100%);">
                                <h3
                                    class="category-title text-white font-medium font-montserrat">Баннеры</h3>
                            </div>

                            <!-- Сервисы -->
                            <div
                                class="category-card rounded-lg"
                                style="background: linear-gradient(135deg, #6b6b6b 0%, #454545 100%);">
                                <h3
                                    class="category-title text-white font-medium font-montserrat">Сервисы</h3>
                            </div>

                            <!-- Кино -->
                            <div
                                class="category-card rounded-lg"
                                style="background: linear-gradient(135deg, #757575 0%, #3d3d3d 100%);">
                                <h3
                                    class="category-title text-white font-medium font-montserrat">Кино</h3>
                            </div>

                            <!-- Новый раздел -->
                            <div
                                class="category-card rounded-lg"
                                style="background: linear-gradient(135deg, #666666 0%, #404040 100%);">
                                <h3
                                    class="category-title text-white font-medium font-montserrat">Новый
                                    раздел</h3> </div>
                        </div>

                        <!-- Рекламный баннер -->
                        <div class="mt-3 px-1">
                            <div class="relative rounded-lg overflow-hidden">
                                <img
                                    src="https://wazir.kg/static/categories/youtube.png"
                                    alt="Самурай Channel"
                                    class="w-full">
                            </div>
                        </div>

                    </div>
                </div>
                <!-- Нижняя навигация -->
                <nav
                    class="bottom-nav fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-10">
                    <div class="flex justify-around items-center py-4">
                        <a href="{{ url_for('dashboard') }}"
                            class="nav-item active">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                width="24"
                                height="24" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="1.75"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="nav-icons"><path
                                    d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline
                                    points="9 22 9 12 15 12 15 22"></polyline></svg>
                        </a>
                        <a href="{{ url_for('search') }}"
                            class="nav-item text-gray-500">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                width="24"
                                height="24" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="1.75"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="nav-icons"><circle cx="11" cy="11"
                                    r="8"></circle><line x1="21" y1="21"
                                    x2="16.65"
                                    y2="16.65"></line></svg>
                        </a>
                        <a href="{{ url_for('chats') }}"
                            class="nav-item text-gray-500">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                width="24"
                                height="24" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="1.75"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="nav-icons"><path
                                    d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                        </a>
                        <a href="{{ url_for('support') }}"
                            class="nav-item text-gray-500">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                width="24"
                                height="24" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="1.75"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="nav-icons"><circle cx="12" cy="12"
                                    r="10"></circle><path
                                    d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line
                                    x1="12" y1="17" x2="12.01"
                                    y2="17"></line></svg>
                        </a>
                        <a href="{{ url_for('profile') }}"
                            class="nav-item text-gray-500">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                width="24"
                                height="24" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="1.75"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="nav-icons"><path
                                    d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle
                                    cx="12" cy="7" r="4"></circle></svg>
                        </a>
                    </div>
                </nav>
            </div>
        </main>
        <script
            src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <!-- Подключаем скрипт для кэширования данных о погоде и курсе валюты -->
        <script
            src="https://wazir.kg/static/layout/assets/js/weather-currency-cache.js"></script>
        <script>
            $(document).ready(function() {
                $('.nav-item').on('click', function() {
                    $('.nav-item').removeClass('active').addClass('text-gray-500');
                    $(this).addClass('active').removeClass('text-gray-500');
                });
                
                // Функция для получения данных о погоде через Visual Crossing Weather
                function getWeather() {
                    // Сначала проверяем, есть ли кэшированные данные
                    const cachedWeather = getWeatherFromCache();
                    if (cachedWeather) {
                        // Если есть кэшированные данные, сразу их отображаем
                        displayWeatherData(cachedWeather);
                        return;
                    }
                    
                    // Если кэша нет или он устарел, запрашиваем данные с API
                    const city = "Osh,Kyrgyzstan";
                    const apiKey = "JPWU9UY254WNDKUNM9MH9E8AR"; // Публичный ключ с ограничениями
                    
                    $.ajax({
                        url: `https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/${city}/today`,
                        data: {
                            unitGroup: "metric",
                            key: apiKey,
                            include: "current"
                        },
                        success: function(data) {
                            try {
                                if (data && data.currentConditions && data.currentConditions.temp !== undefined) {
                                    // Округляем температуру до целого числа
                                    const temp = Math.round(data.currentConditions.temp);
                                    
                                    // Получаем код состояния погоды
                                    const condition = data.currentConditions.conditions ? 
                                        data.currentConditions.conditions.toLowerCase() : '';
                                    const iconCode = data.currentConditions.icon ? 
                                        data.currentConditions.icon.toLowerCase() : '';
                                    
                                    let iconHtml;
                                    // Определяем иконку на основе кода погоды Visual Crossing
                                    if (iconCode.includes('rain') || condition.includes('дождь') || condition.includes('осадки')) {
                                        // Дождь
                                        iconHtml = `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#4c94f2" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="weather-icon"><line x1="16" y1="13" x2="16" y2="21"></line><line x1="8" y1="13" x2="8" y2="21"></line><line x1="12" y1="15" x2="12" y2="23"></line><path d="M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"></path></svg>`;
                                    } else if (iconCode.includes('snow') || condition.includes('снег')) {
                                        // Снег
                                        iconHtml = `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#9cc0fa" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="weather-icon"><path d="M20 17.58A5 5 0 0 0 18 8h-1.26A8 8 0 1 0 4 16.25"></path><line x1="8" y1="16" x2="8.01" y2="16"></line><line x1="8" y1="20" x2="8.01" y2="20"></line><line x1="12" y1="18" x2="12.01" y2="18"></line><line x1="12" y1="22" x2="12.01" y2="22"></line><line x1="16" y1="16" x2="16.01" y2="16"></line><line x1="16" y1="20" x2="16.01" y2="20"></line></svg>`;
                                    } else if (iconCode.includes('thunder') || iconCode.includes('lightning') || condition.includes('гроза')) {
                                        // Гроза
                                        iconHtml = `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#7c8aa0" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="weather-icon"><path d="M19 16.9A5 5 0 0 0 18 7h-1.26a8 8 0 1 0-11.62 9"></path><polyline points="13 11 9 17 15 17 11 23"></polyline></svg>`;
                                    } else if (iconCode.includes('fog') || iconCode.includes('mist') || condition.includes('туман') || condition.includes('дымка')) {
                                        // Туман
                                        iconHtml = `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#7c8aa0" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="weather-icon"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path></svg>`;
                                    } else if (iconCode === 'clear-day' || iconCode === 'clear-night' || condition.includes('ясно')) {
                                        // Ясно
                                        iconHtml = `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="weather-icon"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>`;
                                    } else if (iconCode.includes('cloud') || condition.includes('облачно') || condition.includes('пасмурно')) {
                                        // Облачно
                                        iconHtml = `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#7c8aa0" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="weather-icon"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path></svg>`;
                                    } else {
                                        // По умолчанию или для других условий
                                        iconHtml = `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#7c8aa0" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="weather-icon"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path></svg>`;
                                    }
                                    
                                    // Сохраняем данные в кэш
                                    const weatherData = {
                                        temp: temp,
                                        iconHtml: iconHtml,
                                        condition: condition
                                    };
                                    saveWeatherToCache(weatherData);
                                    
                                    // Отображаем данные
                                    displayWeatherData(weatherData);
                                } else {
                                    getWeatherAlt();
                                }
                            } catch (e) {
                                getWeatherAlt();
                            }
                        },
                        error: function() {
                            // При ошибке используем альтернативный API
                            getWeatherAlt();
                        }
                    });
                }

                // Получение данных о погоде через альтернативный API
                function getWeatherAlt() {
                    // Проверка кэша перед запросом
                    const cachedWeather = getWeatherFromCache();
                    if (cachedWeather) {
                        displayWeatherData(cachedWeather);
                        return;
                    }
                    
                    // Пытаемся получить данные через альтернативный API
                    // В данном случае используем резервные данные
                    showFallbackWeather();
                }
                
                // Показываем резервные данные о погоде
                function showFallbackWeather() {
                    // Сезонные температуры для Оша, Кыргызстан
                    const month = new Date().getMonth() + 1;
                    
                    let temp;
                    if (month >= 12 || month <= 2) {
                        // Зима (декабрь-февраль)
                        temp = -2;
                    } else if (month >= 3 && month <= 5) {
                        // Весна (март-май)
                        temp = 15;
                    } else if (month >= 6 && month <= 8) {
                        // Лето (июнь-август)
                        temp = 28;
                    } else {
                        // Осень (сентябрь-ноябрь)
                        temp = 12;
                    }
                }
                
                function getCurrencyRate() {
                    // Сначала проверяем, есть ли кэшированные данные
                    const cachedCurrency = getCurrencyFromCache();
                    if (cachedCurrency) {
                        // Если есть кэшированные данные, сразу их отображаем
                        displayCurrencyData(cachedCurrency);
                        return;
                    }
                    
                    // Если кэша нет или он устарел, запрашиваем данные с API
                    $.ajax({
                        url: "https://data.fx.kg/api/v1/central",
                        headers: {
                            "Authorization": "Bearer d2WimsDMvhnYStSsq1VRd7jKLZDSS6DQMbzut6rNa9a33c51"
                        },
                        success: function(data) {
                            if (data && data.usd) {
                                const rate = parseFloat(data.usd).toFixed(1);
                                
                                // Сохраняем данные в кэш
                                const currencyData = {
                                    rate: rate,
                                    source: 'fx.kg'
                                };
                                saveCurrencyToCache(currencyData);
                                
                                // Отображаем данные
                                displayCurrencyData(currencyData);
                            } else {
                                // Пробуем альтернативный метод
                                getCurrencyRateAlt();
                            }
                        },
                        error: function() {
                            // При ошибке используем альтернативный метод
                            getCurrencyRateAlt();
                        }
                    });
                }
                
                function getCurrencyRateAlt() {
                    // Проверка кэша перед запросом
                    const cachedCurrency = getCurrencyFromCache();
                    if (cachedCurrency) {
                        displayCurrencyData(cachedCurrency);
                        return;
                    }
                    
                    // В данном случае просто используем резервные данные
                    showFallbackCurrency();
                }
                
                function showFallbackCurrency() {
                    const fallbackData = {
                        rate: '69.8',
                        source: 'fallback'
                    };
                    
                    // Сохраняем резервные данные в кэш
                    saveCurrencyToCache(fallbackData);
                    
                    // Отображаем данные
                    displayCurrencyData(fallbackData);
                }
                
                // Загружаем данные о курсе валют
                getCurrencyRate();
                
                // Обработка клика по элементам навигации
                $('.nav-item').on('click', function() {
                    $('.nav-item').removeClass('active').addClass('text-gray-500');
                    $(this).addClass('active').removeClass('text-gray-500');
                });
            });
        </script>
    </body>
</html>